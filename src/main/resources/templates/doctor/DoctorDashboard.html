<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">

    <head>
        <meta charset="utf-8">
        <meta content="width=device-width, initial-scale=1.0" name="viewport">

        <title>Dashboard - Doctor</title>
        <meta content="" name="description">
        <meta content="" name="keywords">
        <link href='https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.10.2/fullcalendar.min.css' rel='stylesheet'/>
        <!-- Favicons -->
        <link th:href="@{/assets/img/logo.png}" rel="icon">
        <link th:href="@{/assets/img/apple-touch-icon.png}" rel="apple-touch-icon">

        <!-- Google Fonts -->
        <link href="https://fonts.gstatic.com" rel="preconnect">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Nunito:300,300i,400,400i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i"
              rel="stylesheet">

        <!-- Vendor CSS Files -->
        <link th:href="@{/assets/vendor/bootstrap/css/bootstrap.min.css}" rel="stylesheet">
        <link th:href="@{/assets/vendor/bootstrap-icons/bootstrap-icons.css}" rel="stylesheet">
        <link th:href="@{/assets/vendor/boxicons/css/boxicons.min.css}" rel="stylesheet">
        <link th:href="@{/assets/vendor/quill/quill.snow.css}" rel="stylesheet">
        <link th:href="@{/assets/vendor/quill/quill.bubble.css}" rel="stylesheet">
        <link th:href="@{/assets/vendor/remixicon/remixicon.css}" rel="stylesheet">
        <link th:href="@{/assets/vendor/simple-datatables/style.css}" rel="stylesheet">

        <!-- Template Main CSS File -->
        <!--<link th:href="@{/assets/css/style.css" rel="stylesheet"> -->
        <link th:href="@{/assets/css/styleDoctor.css}" rel="stylesheet">


        <!--Links para mensajeria-->

        <!--End link mensajeria-->

        <!-- =======================================================
        * Template Name: NiceAdmin
        * Updated: Mar 09 2023 with Bootstrap v5.2.3
        * Template URL: https://bootstrapmade.com/nice-admin-bootstrap-admin-html-template/
        * Author: BootstrapMade.com
        * License: https://bootstrapmade.com/license/
        ======================================================== -->
    </head>

    <body>

        <!-- ======= Header ======= -->
        <header id="header" class="header fixed-top d-flex align-items-center">

            <div class="d-flex align-items-center justify-content-between">
                <a href="index.html" class="logo d-flex align-items-center">
                    <img th:src="@{/assets/img/logo.png}" alt="">
                    <span class="d-none d-lg-block">Clinica INTERPUCP</span>
                </a>
                <i class="bi bi-list toggle-sidebar-btn"></i>
            </div><!-- End Logo -->


            <nav class="header-nav ms-auto">
                <ul class="d-flex align-items-center">

                    <li class="nav-item d-block d-lg-none">
                        <a class="nav-link nav-icon search-bar-toggle " href="#">
                            <i class="bi bi-search"></i>
                        </a>
                    </li><!-- End Search Icon-->

                    <li class="nav-item dropdown">

                        <a class="nav-link nav-icon" href="#" data-bs-toggle="dropdown">
                            <i class="bi bi-bell"></i>
                            <span class="badge bg-primary badge-number">4</span>
                        </a><!-- End Notification Icon -->

                        <ul class="dropdown-menu dropdown-menu-end dropdown-menu-arrow notifications">
                            <li class="dropdown-header">
                                You have 4 new notifications
                                <a href="#"><span class="badge rounded-pill bg-primary p-2 ms-2">View all</span></a>
                            </li>
                            <li>
                                <hr class="dropdown-divider">
                            </li>

                            <li class="notification-item">
                                <i class="bi bi-exclamation-circle text-warning"></i>
                                <div>
                                    <h4>Lorem Ipsum</h4>
                                    <p>Quae dolorem earum veritatis oditseno</p>
                                    <p>30 min. ago</p>
                                </div>
                            </li>

                            <li>
                                <hr class="dropdown-divider">
                            </li>

                            <li class="notification-item">
                                <i class="bi bi-x-circle text-danger"></i>
                                <div>
                                    <h4>Atque rerum nesciunt</h4>
                                    <p>Quae dolorem earum veritatis oditseno</p>
                                    <p>1 hr. ago</p>
                                </div>
                            </li>

                            <li>
                                <hr class="dropdown-divider">
                            </li>

                            <li class="notification-item">
                                <i class="bi bi-check-circle text-success"></i>
                                <div>
                                    <h4>Sit rerum fuga</h4>
                                    <p>Quae dolorem earum veritatis oditseno</p>
                                    <p>2 hrs. ago</p>
                                </div>
                            </li>

                            <li>
                                <hr class="dropdown-divider">
                            </li>

                            <li class="notification-item">
                                <i class="bi bi-info-circle text-primary"></i>
                                <div>
                                    <h4>Dicta reprehenderit</h4>
                                    <p>Quae dolorem earum veritatis oditseno</p>
                                    <p>4 hrs. ago</p>
                                </div>
                            </li>

                            <li>
                                <hr class="dropdown-divider">
                            </li>
                            <li class="dropdown-footer">
                                <a href="#">Show all notifications</a>
                            </li>

                        </ul><!-- End Notification Dropdown Items -->

                    </li><!-- End Notification Nav -->

                    <li class="nav-item dropdown">

                        <a class="nav-link nav-icon" href="#" data-bs-toggle="dropdown">
                            <i class="bi bi-chat-left-text"></i>
                            <span class="badge bg-success badge-number">3</span>
                        </a><!-- End Messages Icon -->

                        <ul class="dropdown-menu dropdown-menu-end dropdown-menu-arrow messages">
                            <li class="dropdown-header">
                                You have 3 new messages
                                <a href="#"><span class="badge rounded-pill bg-primary p-2 ms-2">View all</span></a>
                            </li>
                            <li>
                                <hr class="dropdown-divider">
                            </li>

                            <li class="message-item">
                                <a href="#">
                                    <img th:src="@{/assets/img/messages-1.jpg}" alt="" class="rounded-circle">
                                    <div>
                                        <h4>Maria Hudson</h4>
                                        <p>Estimado administrador, quisiera solicitar su autorización para realizar una
                                            cirugía ...</p>
                                        <p>4 hrs. ago</p>
                                    </div>
                                </a>
                            </li>
                            <li>
                                <hr class="dropdown-divider">
                            </li>

                            <li class="message-item">
                                <a href="#">
                                    <img th:src="@{/assets/img/messages-2.jpg}" alt="" class="rounded-circle">
                                    <div>
                                        <h4>Anna Nelson</h4>
                                        <p>Hola, quisiera informarle que hay un problema en la plataforma que está
                                            impidiendo ...</p>
                                        <p>6 hrs. ago</p>
                                    </div>
                                </a>
                            </li>
                            <li>
                                <hr class="dropdown-divider">
                            </li>

                            <li class="message-item">
                                <a href="#">
                                    <img th:src="@{/assets/img/messages-3.jpg}" alt="" class="rounded-circle">
                                    <div>
                                        <h4>David Muldon</h4>
                                        <p>Velit asperiores et ducimus soluta repudiandae labore officia est ut...</p>
                                        <p>8 hrs. ago</p>
                                    </div>
                                </a>
                            </li>
                            <li>
                                <hr class="dropdown-divider">
                            </li>

                            <li class="dropdown-footer">
                                <a href="#">Show all messages</a>
                            </li>

                        </ul><!-- End Messages Dropdown Items -->

                    </li><!-- End Messages Nav -->

                    <li class="nav-item dropdown pe-3">

                        <a class="nav-link nav-profile d-flex align-items-center pe-0" href="#"
                           data-bs-toggle="dropdown">
                            <img th:src="@{/assets/img/profile-img.jpg}" alt="Profile" class="rounded-circle">
                            <span class="d-none d-md-block dropdown-toggle ps-2">J. Dominguez</span>
                        </a><!-- End Profile Iamge Icon -->

                        <ul class="dropdown-menu dropdown-menu-end dropdown-menu-arrow profile">
                            <li class="dropdown-header">
                                <h6>Jorge Dominguez</h6>
                                <span>Administrador de sede</span>
                            </li>
                            <li>
                                <hr class="dropdown-divider">
                            </li>

                            <li>
                                <a class="dropdown-item d-flex align-items-center" href="users-profile.html">
                                    <i class="bi bi-person"></i>
                                    <span>Mi Perfil</span>
                                </a>
                            </li>
                            <li>
                                <hr class="dropdown-divider">
                            </li>

                            <li>
                                <a class="dropdown-item d-flex align-items-center" href="users-profile.html">
                                    <i class="bi bi-gear"></i>
                                    <span>Configuraciones</span>
                                </a>
                            </li>
                            <li>
                                <hr class="dropdown-divider">
                            </li>


                            <li>
                                <hr class="dropdown-divider">
                            </li>

                            <li>
                                <a class="dropdown-item d-flex align-items-center" href="#">
                                    <i class="bi bi-box-arrow-right"></i>
                                    <span>Cerrar Sesión</span>
                                </a>
                            </li>

                        </ul><!-- End Profile Dropdown Items -->
                    </li><!-- End Profile Nav -->

                </ul>
            </nav><!-- End Icons Navigation -->

        </header><!-- End Header -->

        <!-- ======= Sidebar ======= -->
        <aside id="sidebar" class="sidebar">

            <ul class="sidebar-nav" id="sidebar-nav">

                <li class="nav-item">
                    <a class="nav-link " th:href="@{/doctor/dashboard}">
                        <i class="bi bi-grid"></i>
                        <span>Dashboard</span>
                    </a>
                </li><!-- End Dashboard Nav -->
                <li class="nav-item">
                    <a class="nav-link collapsed">
                        <i class="bi bi-card-text"></i>
                        <span>Reportes</span>
                    </a>
                </li><!-- End Profile Page Nav -->
                <li class="nav-item">
                    <a class="nav-link collapsed" th:href="@{/doctor/calendario}">
                        <i class="bi bi-calendar"></i>
                        <span>Calendario General</span>
                    </a>
                </li><!-- End Profile Page Nav -->

                <li class="nav-item">
                    <a class="nav-link collapsed" th:href="@{/doctor/recibo}">
                        <i class="bi bi-currency-exchange"></i>
                        <span>Recibos</span>
                    </a>
                </li><!-- End Profile Page Nav -->

                <li class="nav-item">
                    <a class="nav-link collapsed" th:href="@{/doctor/mensajeria}">
                        <i class="bi bi-chat-quote"></i>
                        <span>Mensajería</span>
                    </a>
                </li><!-- End Profile Page Nav -->
            </ul>

        </aside><!-- End Sidebar-->

        <main id="main" class="main">

            <div style="margin-left: 30px" class="pagetitle">
                <h1>Dashboard</h1>

            </div><!-- End Page Title -->

            <section class="section dashboard">
                <div class="row">

                    <!-- Left side columns -->
                    <div class="col-lg-12">
                        <div class="row">

                            <!-- Top Selling -->
                            <div style="width: auto" class="col-6">
                                <div class="card top-selling overflow-auto container">


                                    <div class="card-body pb-0">
                                        <h5 class="card-title">PRÓXIMAS CITAS<span>| Sede San Miguel</span></h5>
                                        <div class="container-fluid">
                                            <form method="post" th:action="@{/doctor/BuscarProxCita}">
                                                <input name="searchField" class="form-control mb-3" type="text"
                                                       placeholder="Buscar por nombre"/>
                                            </form>
                                        </div>
                                        <br>

                                        <div class="d-flex flex-column"
                                             style="height: 485px; overflow: auto;width: max-content">
                                            <div class="table-responsive">
                                                <table class="table">
                                                    <thead style="text-align: center">
                                                        <tr>
                                                            <th scope="col">Nombre</th>
                                                            <th scope="col">Tipo de cita</th>
                                                            <th scope="col">Horario</th>
                                                            <th style="width: 108px" scope="col">Pendiente de exámenes
                                                            </th>
                                                            <th scope="col"></th>
                                                        </tr>
                                                    </thead>
                                                    <tbody style="text-align: center">
                                                        <tr th:each="cita,obj: ${listaCitas}"
                                                            th:with="horario=${listaHorarios[obj.index]}">


                                                            <td style="font-size: 1rem"
                                                                th:text="${cita.getNombre() + ' ' + cita.getApellidos()}">

                                                            </td>

                                                            <td style="font-size: 1rem">
                                                                <h6 th:text="${ cita.modalidad==0 ? 'Presencial' : 'Virtual'}"></h6>
                                                            </td>


                                                            <td style="font-size: 1rem;color: black"
                                                                th:text="${horario}">

                                                            </td>

                                                            <td style="font-size: 1rem;color: black">
                                                                <h6 th:if="${cita.estado == 0}"
                                                                    th:text="'Próxima cita'"></h6>
                                                                <h6 th:if="${cita.estado == 1}"
                                                                    th:text="'Registrado en caja'"></h6>
                                                                <h6 th:if="${cita.estado == 2}"
                                                                    th:text="'En espera'"></h6>
                                                                <h6 th:if="${cita.estado == 3}"
                                                                    th:text="'En consulta'"></h6>
                                                            </td>


                                                            <td th:if="${cita.modalidad == 1}">
                                                                <div style="width: min-content">
                                                                    <a th:href="@{'/doctor/reporte?id=' + ${cita.getId_paciente()}+ '&id2=' + ${cita.getId_cita()}}"
                                                                       type="button" class="btn btn-success">Iniciar
                                                                        cita</a>
                                                                    <button style="margin-top: 5px;width: max-content"
                                                                            type="button" class="btn btn-danger">Enviar
                                                                        cuestionario
                                                                    </button>
                                                                </div>
                                                            </td>
                                                            <td th:unless="${cita.modalidad == 1}">
                                                                <!-- no se muestra nada si la modalidad es presencial -->
                                                            </td>

                                                        </tr>


                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>

                                    </div>

                                </div>
                            </div><!-- End Top Selling -->
                            <div class="col-5">
                                <div class="card top-selling overflow-auto container"
                                     style="height: 625px; overflow: auto;">
                                    <div class="card-body pb-0">
                                        <h5 class="card-title">CALENDARIO</h5>
                                        <section class="section dashboard">
                                            <div class="row bg-white p-3">
                                                <script>

                                                    document.addEventListener('DOMContentLoaded', function () {
                                                        var calendarEl = document.getElementById('calendar');

                                                        var calendar = new FullCalendar.Calendar(calendarEl, {
                                                            headerToolbar: {
                                                                left: 'prev,next today',
                                                                center: 'title',
                                                                right: 'dayGridMonth,timeGridWeek,timeGridDay'
                                                            },
                                                            initialDate: '2023-01-12',
                                                            navLinks: true, // can click day/week names to navigate views
                                                            selectable: true,
                                                            selectMirror: true,
                                                            select: function (arg) {
                                                                var title = prompt('Event Title:');
                                                                if (title) {
                                                                    calendar.addEvent({
                                                                        title: title,
                                                                        start: arg.start,
                                                                        end: arg.end,
                                                                        allDay: arg.allDay
                                                                    })
                                                                }
                                                                calendar.unselect()
                                                            },
                                                            eventClick: function (arg) {
                                                                if (confirm('¿Estás seguro que deseas eliminar este evento?')) {
                                                                    arg.event.remove()
                                                                }
                                                            },
                                                            editable: true,
                                                            dayMaxEvents: true, // allow "more" link when too many events
                                                            events: [
                                                                {
                                                                    title: 'All Day Event',
                                                                    start: '2023-01-01'
                                                                },
                                                                {
                                                                    title: 'Long Event',
                                                                    start: '2023-01-07',
                                                                    end: '2023-01-10'
                                                                },
                                                                {
                                                                    groupId: 999,
                                                                    title: 'Repeating Event',
                                                                    start: '2023-01-09T16:00:00'
                                                                },
                                                                {
                                                                    groupId: 999,
                                                                    title: 'Repeating Event',
                                                                    start: '2023-01-16T16:00:00'
                                                                },
                                                                {
                                                                    title: 'Conference',
                                                                    start: '2023-01-11',
                                                                    end: '2023-01-13'
                                                                },
                                                                {
                                                                    title: 'Meeting',
                                                                    start: '2023-01-12T10:30:00',
                                                                    end: '2023-01-12T12:30:00'
                                                                },
                                                                {
                                                                    title: 'Lunch',
                                                                    start: '2023-01-12T12:00:00'
                                                                },
                                                                {
                                                                    title: 'Meeting',
                                                                    start: '2023-01-12T14:30:00'
                                                                },
                                                                {
                                                                    title: 'Happy Hour',
                                                                    start: '2023-01-12T17:30:00'
                                                                },
                                                                {
                                                                    title: 'Dinner',
                                                                    start: '2023-01-12T20:00:00'
                                                                },
                                                                {
                                                                    title: 'Birthday Party',
                                                                    start: '2023-01-13T07:00:00'
                                                                },
                                                                {
                                                                    title: 'Click for Google',
                                                                    url: 'http://google.com/',
                                                                    start: '2023-01-28'
                                                                }
                                                            ]
                                                        });

                                                        calendar.render();
                                                    });

                                                </script>
                                                <div id='calendar'></div>

                                            </div>

                                        </section>
                                    </div>
                                </div>


                            </div>
                            <div style="margin-left: -20px" class="col-6">


                                    <div class="card-body pb-0">
                                        <div class="card top-selling overflow-auto container">


                                            <div class="card-body pb-0">
                                                <h5 class="card-title">PACIENTES<span>| Sede San Miguel</span></h5>
                                                <div class="container-fluid">
                                                    <form method="post" th:action="@{/doctor/BuscarPaciente}">
                                                        <input name="searchField" class="form-control mb-3" type="text"
                                                               placeholder="Buscar por nombre"/>
                                                    </form>
                                                </div>
                                                <br>

                                                <div class="d-flex flex-column" style="height: 485px; overflow: auto;">
                                                    <div class="table">
                                                        <table class="table table-striped">
                                                            <thead>
                                                                <tr >
                                                                    <th></th>
                                                                    <th style="text-align: center">Nombres</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <tr th:each="paciente,obj: ${listaPacientes}">
                                                                    <td>
                                                                        <img style="border-radius: 50%;border: 2px solid #000"
                                                                             th:src="@{'/usuario/foto/'+${paciente.getId_paciente()}}"
                                                                             height="70" width="70" alt="Profile">
                                                                    </td>
                                                                    <td style="font-size: 1rem; color: black">
                                                                        <a th:href="@{/doctor/dashboard}"
                                                                           th:text="${paciente.getNombre() + ' ' + paciente.getApellidos()}"></a>


                                                                    </td>

                                                                </tr>


                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>

                                            </div>

                                        </div>


                                    </div>



                            </div><!-- End Left side columns -->
                        </div><!-- End Left side columns -->

                        <!-- Right side columns -->



                    </div>


                </div><!-- End Website Traffic -->


                </div><!-- End Right side columns -->

                </div>
            </section>

        </main><!-- End #main -->

        <!-- ======= Footer ======= -->
        <footer id="footer" class="footer">

            <div class="credits">
                <!-- All the links in the footer should remain intact. -->
                <!-- You can delete the links only if you purchased the pro version. -->
                <!-- Licensing information: https://bootstrapmade.com/license/ -->
                <!-- Purchase the pro version with working PHP/AJAX contact form: https://bootstrapmade.com/nice-admin-bootstrap-admin-html-template/ -->

            </div>
        </footer><!-- End Footer -->

        <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i
                class="bi bi-arrow-up-short"></i></a>

        <!-- Vendor JS Files -->
        <script th:src="@{/assets/vendor/apexcharts/apexcharts.min.js}"></script>
        <script th:src="@{/assets/vendor/bootstrap/js/bootstrap.bundle.min.js}"></script>
        <script th:src="@{/assets/vendor/chart.js/chart.umd.js}"></script>
        <script th:src="@{/assets/vendor/echarts/echarts.min.js}"></script>
        <script th:src="@{/assets/vendor/quill/quill.min.js}"></script>
        <script th:src="@{/assets/vendor/simple-datatables/simple-datatables.js}"></script>
        <script th:src="@{/assets/vendor/tinymce/tinymce.min.js}"></script>
        <script th:src="@{/assets/vendor/php-email-form/validate.js}"></script>
        <!-- Agregamos las librerías de jQuery y Bootstrap 5 -->


        <!-- Template Main JS File -->
        <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
        <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/js/bootstrap.min.js"
                integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
                crossorigin="anonymous"></script>
        <script th:src="@{/assets/js/jsDoctor.js}"></script>

        <!-- Scripts Calendario -->


        <!-- Agregar la biblioteca FullCalendar -->
        <script src='https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js'></script>
        <script src='https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.10.2/fullcalendar.min.js'></script>
        <script th:src="@{/assets/js/index.js}"></script>
        <script th:src="@{/assets/js/datatables.js}"></script>
        <script th:src="@{/assets/js/moment.js}"></script>
        <script>// Obtener una referencia al elemento HTML donde se mostrará el calendario
        var calendarEl = document.getElementById('calendar');

        // Configurar las opciones del calendario
        var calendar = new FullCalendar.Calendar(calendarEl, {
            initialView: 'dayGridMonth',
            headerToolbar: {
                left: 'prev,next today',
                center: 'title',
                right: 'dayGridMonth,timeGridWeek,timeGridDay'
            },
            events: [
                {
                    title: 'Evento 1',
                    start: '2023-04-25'
                },
                {
                    title: 'Evento 2',
                    start: '2023-04-26T12:30:00',
                    end: '2023-04-26T14:30:00'
                },
                {
                    title: 'Evento 3',
                    start: '2023-04-27T12:00:00',
                    end: '2023-04-27T16:00:00'
                }
            ]
        });

        // Mostrar el calendario
        calendar.render();
        </script>


    </body>


</html>